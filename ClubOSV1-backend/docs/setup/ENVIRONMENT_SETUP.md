# ClubOSV1 Environment Setup Guide

This guide helps you set up your development environment for ClubOSV1.

## Quick Setup

1. **Generate secure secrets** (from CLUBOSV1 directory):
   ```bash
   ./generate-secrets.sh
   ```

2. **Check your configuration** (from backend directory):
   ```bash
   npm run check
   ```

3. **Add your API keys** to `.env`:
   - OpenAI API key (for AI features)
   - Slack webhook URL (for Slack integration)

## Environment Variables

### Required Variables

| Variable | Description | Example |
|----------|-------------|---------|
| `PORT` | Server port | `3001` |
| `NODE_ENV` | Environment mode | `development` |
| `JWT_SECRET` | JWT signing secret (32+ chars) | Generated by script |
| `SESSION_SECRET` | Session secret (32+ chars) | Generated by script |

### Optional Variables (Features)

| Variable | Description | Required For |
|----------|-------------|--------------|
| `OPENAI_API_KEY` | OpenAI API key | AI/LLM features |
| `SLACK_WEBHOOK_URL` | Slack webhook | Slack notifications |
| `FRONTEND_URL` | Frontend URL | CORS configuration |

### Configuration Options

| Variable | Default | Description |
|----------|---------|-------------|
| `LOG_LEVEL` | `info` | Logging level (debug/info/warn/error) |
| `DATA_RETENTION_DAYS` | `90` | Days to keep data |
| `RATE_LIMIT_MAX` | `100` | Max requests per window |
| `RATE_LIMIT_WINDOW_MS` | `900000` | Rate limit window (15 min) |

## Setup Steps

### 1. Initial Setup

```bash
# Copy environment template
cp .env.template .env

# Generate secure secrets
./generate-secrets.sh

# Check configuration
npm run check
```

### 2. Add API Keys

Edit `.env` and add your keys:

```env
# OpenAI (get from https://platform.openai.com/api-keys)
OPENAI_API_KEY=sk-...

# Slack (get from https://api.slack.com/apps)
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/...
```

### 3. Verify Setup

```bash
# Run configuration check
npm run check:env

# All checks should pass
```

## Environment Modes

### Development (default)
```env
NODE_ENV=development
LOG_LEVEL=debug
ENABLE_DEBUG_ENDPOINTS=true
```

### Production
```env
NODE_ENV=production
LOG_LEVEL=info
ENABLE_DEBUG_ENDPOINTS=false
# Use generated secrets (not defaults!)
```

### Testing
```env
NODE_ENV=test
LOG_LEVEL=error
```

## Troubleshooting

### "Environment validation failed"
- Run `npm run check` to see what's missing
- Ensure all required variables are set
- Check that secrets are at least 32 characters

### "OPENAI_API_KEY not set"
- AI features will be disabled
- Get a key from https://platform.openai.com

### "SLACK_WEBHOOK_URL not set"
- Slack integration will be disabled
- Create a Slack app at https://api.slack.com

### Port conflicts
- Change `PORT` in `.env` if 3001 is in use
- Update `FRONTEND_URL` if frontend port changes

## Security Notes

1. **Never commit `.env` to version control**
2. **Always use generated secrets in production**
3. **Rotate secrets regularly**
4. **Use different secrets for each environment**

## Features by Environment Variable

| Feature | Required Variable | Fallback |
|---------|-------------------|----------|
| AI Routing | `OPENAI_API_KEY` | Local routing |
| Slack Notifications | `SLACK_WEBHOOK_URL` | Console logging |
| Rate Limiting | Always enabled | Default limits |
| Request Logging | Always enabled | File + console |

## Next Steps

After environment setup:

1. Install dependencies: `npm install`
2. Run development server: `npm run dev`
3. Check health endpoint: http://localhost:3001/health

For production deployment, see the deployment guide.
