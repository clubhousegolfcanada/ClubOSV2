#!/bin/bash
# Fix the OpenPhone conversations database error

echo "ðŸ”§ Fixing OpenPhone Recent Conversations Error"
echo "============================================"
echo ""
echo "The error is caused by a missing 'conversation_id' column in the database."
echo ""
echo "To fix this on Railway:"
echo ""
echo "1. Open Railway Dashboard"
echo "2. Go to your ClubOSV2 project"
echo "3. Click on the Postgres database"
echo "4. Go to the 'Query' tab"
echo "5. Run this SQL command:"
echo ""
echo "ALTER TABLE openphone_conversations ADD COLUMN IF NOT EXISTS conversation_id VARCHAR(255) UNIQUE;"
echo ""
echo "Alternative method - using Railway CLI:"
echo ""
echo "railway run psql \$DATABASE_URL -c \"ALTER TABLE openphone_conversations ADD COLUMN IF NOT EXISTS conversation_id VARCHAR(255) UNIQUE;\""
echo ""
echo "After running the migration:"
echo "- The 500 errors will stop"
echo "- Recent Messages will load properly"
echo "- Preview Import will work without console errors"
echo ""
echo "Note: This doesn't affect the import functionality itself,"
echo "just cleans up the console errors from the auto-refreshing Recent Messages."
